---
// src/components/landing/Demo.astro
---

<section id="demo" class="py-24 md:py-32 section bg-stone-50 dark:bg-[#0c0a09] overflow-hidden relative">
  
  <div class="absolute top-1/2 left-0 -translate-y-1/2 w-[500px] h-[500px] bg-rose-200/20 dark:bg-rose-900/10 rounded-full blur-[120px] pointer-events-none"></div>

  <div class="container-max relative z-10">
    
    <div class="text-center mb-16 max-w-2xl mx-auto">
      <span class="font-body text-xs font-bold uppercase tracking-[0.25em] text-rose-600 mb-4 block">
        Interactive Studio
      </span>
      <h2 class="font-heading text-4xl md:text-5xl text-stone-900 dark:text-stone-100 font-light mb-6">
        Uniquely Yours, <br/> Crafted by Us.
      </h2>
      <p class="text-stone-600 dark:text-stone-400 text-lg leading-relaxed">
        Your invitation is the first moment of your celebration. Use the controls below to personalize the preview instantly.
      </p>
    </div>

    <div class="grid lg:grid-cols-2 gap-12 lg:gap-24 items-center max-w-5xl mx-auto">
      
      <div class="order-2 lg:order-1">
        <div class="bg-white dark:bg-stone-900/50 backdrop-blur-sm p-8 rounded-[2rem] border border-stone-100 dark:border-stone-800 shadow-xl shadow-stone-200/50 dark:shadow-none">
          
          <div class="space-y-8">
            <div>
              <label class="block text-[10px] uppercase tracking-widest text-stone-400 font-bold mb-3">Couple Names</label>
              <input 
                type="text" 
                id="preview-name" 
                value="Rohan & Maya" 
                class="w-full bg-stone-50 dark:bg-stone-950 border border-stone-200 dark:border-stone-700 rounded-xl px-4 py-3 text-2xl font-heading text-stone-900 dark:text-stone-100 focus:ring-2 focus:ring-rose-500/20 focus:border-rose-500 outline-none transition-all placeholder-stone-300"
              />
            </div>

            <div>
              <label class="block text-[10px] uppercase tracking-widest text-stone-400 font-bold mb-3">Celebration Date</label>
              <input 
                type="text" 
                id="preview-date" 
                value="January 16, 2026" 
                class="w-full bg-stone-50 dark:bg-stone-950 border border-stone-200 dark:border-stone-700 rounded-xl px-4 py-3 text-lg font-body text-stone-600 dark:text-stone-300 focus:ring-2 focus:ring-rose-500/20 focus:border-rose-500 outline-none transition-all placeholder-stone-300"
              />
            </div>

            <div class="pt-8 mt-4 flex items-center justify-between border-t border-stone-100 dark:border-stone-800">
              
              <div class="flex flex-col gap-3">
                <span class="text-[10px] uppercase tracking-widest text-stone-400 font-bold">Ambiance</span>
                
                <div class="inline-flex bg-stone-100 dark:bg-stone-800 p-1 rounded-lg gap-1">
                  <button 
                    data-theme="minimalist" 
                    class="theme-btn px-4 py-1.5 rounded-md text-[10px] font-bold uppercase tracking-wider transition-all bg-white dark:bg-stone-700 shadow-sm text-stone-900 dark:text-stone-100"
                  >
                    Minimalist
                  </button>
                  
                  <button 
                    data-theme="floral" 
                    class="theme-btn px-4 py-1.5 rounded-md text-[10px] font-bold uppercase tracking-wider transition-all text-stone-500 hover:text-stone-900 dark:hover:text-stone-100"
                  >
                    Floral
                  </button>
                  
                  <button 
                    data-theme="midnight" 
                    class="theme-btn px-4 py-1.5 rounded-md text-[10px] font-bold uppercase tracking-wider transition-all text-stone-500 hover:text-stone-900 dark:hover:text-stone-100"
                  >
                    Midnight
                  </button>
                </div>
              </div>
              
              <div class="text-right">
                <span class="text-[10px] uppercase tracking-widest text-stone-400 font-bold block mb-1">Status</span>
                <span class="inline-flex items-center gap-2 text-[10px] font-bold text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-900/20 px-3 py-1.5 rounded-full">
                  <span class="w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"></span>
                  LIVE
                </span>
              </div>
            </div>

          </div>
        </div>
      </div>

      <div class="order-1 lg:order-2 flex justify-center perspective-1000">
        <div class="relative w-[300px] h-[600px] bg-stone-900 rounded-[3rem] shadow-2xl border-[8px] border-stone-900 ring-1 ring-stone-900/50 overflow-hidden transform transition-transform duration-700 hover:rotate-y-6 hover:rotate-x-6 select-none">
          
          <div class="absolute top-0 left-1/2 -translate-x-1/2 w-28 h-6 bg-stone-900 rounded-b-xl z-50"></div>

          <div id="phone-screen" class="w-full h-full relative overflow-hidden flex flex-col transition-colors duration-500 bg-stone-50">
            
            <div class="absolute inset-0 opacity-40 bg-[url('https://www.transparenttextures.com/patterns/cream-paper.png')] pointer-events-none mix-blend-multiply"></div>

            <div class="relative z-10 flex-1 flex flex-col items-center justify-center p-6 text-center">
              
              <div 
                id="card-monogram"
                class="w-16 h-16 mb-8 rounded-full border border-stone-300 flex items-center justify-center font-serif italic text-2xl bg-white/50 backdrop-blur-sm shadow-sm transition-all duration-500 text-rose-600"
              >
                R&M
              </div>

              <span id="card-label" class="text-[10px] uppercase tracking-[0.3em] mb-4 transition-colors duration-500 text-stone-500">The Wedding Of</span>
              
              <h2 id="card-name" class="font-heading text-4xl leading-tight mb-6 transition-colors duration-500 text-stone-900">
                Rohan & <br/> Maya
              </h2>
              
              <p id="card-date" class="font-serif italic text-base border-y py-2 px-6 transition-colors duration-500 border-stone-200 text-stone-500">
                January 16, 2026
              </p>

              <div class="mt-10 w-full px-4">
                <div id="card-btn" class="h-10 w-full rounded-lg flex items-center justify-center text-[10px] font-bold tracking-widest uppercase shadow-lg transition-colors duration-500 bg-stone-900 text-white">
                  RSVP Now
                </div>
              </div>

            </div>

            <div class="absolute bottom-2 left-1/2 -translate-x-1/2 w-1/3 h-1 bg-stone-300/50 rounded-full"></div>
          </div>
        </div>
      </div>

    </div>
  </div>
</section>

<script>
  // --- ELEMENTS ---
  const nameInput = document.getElementById('preview-name');
  const dateInput = document.getElementById('preview-date');
  
  // Phone Elements
  const cardName = document.getElementById('card-name');
  const cardDate = document.getElementById('card-date');
  const cardMonogram = document.getElementById('card-monogram');
  const phoneScreen = document.getElementById('phone-screen');
  const cardLabel = document.getElementById('card-label');
  const cardBtn = document.getElementById('card-btn');

  // --- LOGIC: UPDATE TEXT ---
  const getInitials = (text) => {
    const clean = text.replace(/[^a-zA-Z\s]/g, '');
    const parts = clean.split(' ').filter(p => p.length > 0);
    if (parts.length >= 2) return `${parts[0][0]}&${parts[1][0]}`;
    if (parts.length === 1) return parts[0].substring(0, 2).toUpperCase();
    return 'K';
  };

  const updatePreview = () => {
    if (nameInput) {
      if (cardName) cardName.innerHTML = nameInput.value.replace('&', '<br/>&');
      if (cardMonogram) cardMonogram.innerText = getInitials(nameInput.value);
    }
    if (cardDate && dateInput) cardDate.innerText = dateInput.value;
  };

  nameInput?.addEventListener('input', updatePreview);
  dateInput?.addEventListener('input', updatePreview);

  // --- LOGIC: CHANGE THEME ---
  const themeBtns = document.querySelectorAll('.theme-btn');
  
  // Define classes for states
  const activeClasses = ['bg-white', 'dark:bg-stone-700', 'shadow-sm', 'text-stone-900', 'dark:text-stone-100'];
  const inactiveClasses = ['text-stone-500', 'hover:text-stone-900', 'dark:hover:text-stone-100'];

  // Theme Configurations (Tailwind Classes)
  const themes = {
    minimalist: {
      bg: 'bg-stone-50',
      textMain: 'text-stone-900',
      textSub: 'text-stone-500',
      border: 'border-stone-200',
      btnBg: 'bg-stone-900',
      btnText: 'text-white',
      accent: 'text-rose-600'
    },
    floral: {
      bg: 'bg-[#fff0f3]', // Very light pink
      textMain: 'text-[#881337]', // Rose-900
      textSub: 'text-[#9f1239]', // Rose-800
      border: 'border-[#fecdd3]', // Rose-200
      btnBg: 'bg-[#be123c]', // Rose-700
      btnText: 'text-white',
      accent: 'text-[#be123c]'
    },
    midnight: {
      bg: 'bg-[#0c0a09]', // Stone-950
      textMain: 'text-stone-50',
      textSub: 'text-stone-400',
      border: 'border-stone-800',
      btnBg: 'bg-stone-50',
      btnText: 'text-stone-900',
      accent: 'text-stone-200'
    }
  };

  themeBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      // 1. UPDATE BUTTON VISUALS (Swap classes manually since we removed @apply)
      themeBtns.forEach(b => {
        b.classList.remove(...activeClasses);
        b.classList.add(...inactiveClasses);
      });
      btn.classList.remove(...inactiveClasses);
      btn.classList.add(...activeClasses);

      // 2. APPLY THEME TO PHONE
      const themeName = btn.getAttribute('data-theme');
      const t = themes[themeName];

      if (phoneScreen && t) {
        phoneScreen.className = `w-full h-full relative overflow-hidden flex flex-col transition-colors duration-500 ${t.bg}`;
        if (cardName) cardName.className = `font-heading text-4xl leading-tight mb-6 transition-colors duration-500 ${t.textMain}`;
        if (cardLabel) cardLabel.className = `text-[10px] uppercase tracking-[0.3em] mb-4 transition-colors duration-500 ${t.textSub}`;
        if (cardDate) cardDate.className = `font-serif italic text-base border-y py-2 px-6 transition-colors duration-500 ${t.border} ${t.textSub}`;
        if (cardBtn) cardBtn.className = `h-10 w-full rounded-lg flex items-center justify-center text-[10px] font-bold tracking-widest uppercase shadow-lg transition-colors duration-500 ${t.btnBg} ${t.btnText}`;
        if (cardMonogram) cardMonogram.className = `w-16 h-16 mb-8 rounded-full border flex items-center justify-center font-serif italic text-2xl bg-white/50 backdrop-blur-sm shadow-sm transition-all duration-500 ${t.border} ${t.accent}`;
      }
    });
  });
</script>

<style>
  /* 3D Transform Utilities (Safe to keep as standard CSS) */
  .perspective-1000 { perspective: 1000px; }
  .rotate-y-6 { transform: rotateY(-6deg); }
  .rotate-x-6 { transform: rotateX(6deg); }
</style>